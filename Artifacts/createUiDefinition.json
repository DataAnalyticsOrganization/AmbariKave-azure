{
  "handler": "Microsoft.Compute.MultiVm",
  "version": "0.0.1-preview",
  "parameters": {
    "basics": [
      {
        "name": "KAVEAdminUserName",
        "type": "Microsoft.Compute.UserNameTextBox",
        "label": "KAVE admin",
        "defaultValue": "",
        "toolTip": "Enter a KAVE admin user name.",
        "constraints": {
          "required": true,
          "regex": "^[a-z]{6,32}$",
          "validationMessage": "The user name must be between 6 and 32 characters long, and can contain only lowercase letters."
        },
        "osPlatform": "Linux",
        "visible": true
      },
      {
        "name": "KAVEAdminPassword",
        "type": "Microsoft.Compute.CredentialsCombo",
        "label": {
          "password": "Password",
          "confirmPassword": "Confirm password"
        },
        "toolTip": {
          "password": "Enter a KAVE admin password. "
        },
        "osPlatform": "Windows",
        "constraints": {
          "required": true
        }
      }
    ],
    "steps": [
      {
        "name": "storageConfig",
        "label": "Storage",
        "subLabel": {
          "preValidation": "Configure storage settings",
          "postValidation": "Done"
        },
        "bladeTitle": "Storage",
        "elements": [
          {
            "name": "saName",
            "type": "Microsoft.Storage.StorageAccountSelector",
            "label": "Storage account",
            "toolTip": "",
            "defaultValue": {
              "name": "",
              "type": "Standard_LRS"
            },
            "constraints": {
              "allowedTypes": [
                "Standard_LRS"
              ]
            },
            "options": {
              "hideExisting": true
            },
            "visible": true
          },
          {
            "name": "saPremiumName",
            "type": "Microsoft.Storage.StorageAccountSelector",
            "label": "Premium Storage account",
            "toolTip": "If no storage account type is available, please choose another location on the first blade called 'Basics' and try again.",
            "defaultValue": {
              "name": "",
              "type": "Premium_LRS"
            },
            "constraints": {
              "allowedTypes": [
                "Premium_LRS"
              ]
            },
            "options": {
              "hideExisting": true
            },
            "visible": true
          }
        ]
      },
      {
        "name": "dnsConfig",
        "label": "DNS name label",
        "subLabel": {
          "preValidation": "Configure DNS prefix",
          "postValidation": "Done"
        },
        "bladeTitle": "DNS name label",
        "elements": [
          {
            "name": "dnsConfigName",
            "type": "Microsoft.Network.PublicIpAddressCombo",
            "label": {
              "publicIpAddress": "Configure Public IP address",
              "domainNameLabel": "Configure DNS prefix"
            },
            "toolTip": {
              "publicIpAddress": "Choose name for the Public IP address",
              "domainNameLabel": "An 'A record' that starts with the specified label and resolves to this public IP address will be registered with the Azure-provided DNS servers. Example: mylabel.westus.cloudapp.azure.com."
            },
            "defaultValue": {
              "publicIpAddressName": "",
              "domainNameLabel": ""
            },
            "constraints": {
              "required": {
                "domainNameLabel": true
              }
            },
            "options": {
              "hideNone": true,
              "hideDomainNameLabel": false,
              "hideExisting": false
            },
            "visible": true
          }
        ]
      }
    ],
    "outputs": {
      "KAVEAdminUserName": "[basics('KAVEAdminUserName')]",
      "KAVEAdminPassword": "[basics('KAVEAdminPassword').password]",
      "saName": "[steps('storageConfig').saName.name]",
      "saPremiumName": "[steps('storageConfig').saPremiumName.name]",
      "dnsLabelPrefix": "[steps('dnsConfig').dnsConfigName.domainNameLabel]"
    }
  }
}
